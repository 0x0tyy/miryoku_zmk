// Copyright 2022 Manna Harbour
// https://github.com/manna-harbour/miryoku

#define MIRYOKU_KLUDGE_TOPROWCOMBOS_TERM 50
#define MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(layer, position, binding) \
toprowcombos_ ## layer ## _ ## position { \
  layers = <layer>; \
  key-positions = <MIRYOKU_KLUDGE_TOPROWCOMBOS_ ## position>; \
  bindings = <binding>; \
  timeout-ms = <MIRYOKU_KLUDGE_TOPROWCOMBOS_TERM>; \
};

/ {
  combos {
    compatible = "zmk,combos";
#if defined (MIRYOKU_LAYERS_FLIP)
  #if defined (MIRYOKU_ALPHAS_AZERTY)
  #elif defined (MIRYOKU_ALPHAS_BEAKL15)
  #elif defined (MIRYOKU_ALPHAS_COLEMAK)
  #elif defined (MIRYOKU_ALPHAS_COLEMAKDHK)
  #elif defined (MIRYOKU_ALPHAS_DVORAK)
  #elif defined (MIRYOKU_ALPHAS_HALMAK)
  #elif defined (MIRYOKU_ALPHAS_WORKMAN)
  #elif defined (MIRYOKU_ALPHAS_QWERTY)
  #elif defined (MIRYOKU_ALPHAS_QWERTZ)
  #else
  #endif
  #if defined (MIRYOKU_NAV_INVERTEDT)
  #elif defined (MIRYOKU_NAV_VI)
  #else
  #endif
#else
  #if defined (MIRYOKU_ALPHAS_AZERTY)
  #elif defined (MIRYOKU_ALPHAS_BEAKL15)
  #elif defined (MIRYOKU_ALPHAS_COLEMAK)
  #elif defined (MIRYOKU_ALPHAS_COLEMAKDHK)
  #elif defined (MIRYOKU_ALPHAS_DVORAK)
  #elif defined (MIRYOKU_ALPHAS_HALMAK)
  #elif defined (MIRYOKU_ALPHAS_WORKMAN)
  #elif defined (MIRYOKU_ALPHAS_QWERTY)
  #elif defined (MIRYOKU_ALPHAS_QWERTZ)
  #else
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(BASE, LEFTPINKIE, &kp Q)
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(BASE, LEFTINNERINDEX, &kp B)
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(BASE, RIGHTINNERINDEX, &kp J)
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(BASE, RIGHTPINKIE, &kp SQT)
  #endif
  #if defined (MIRYOKU_NAV_INVERTEDT)
  #elif defined (MIRYOKU_NAV_VI)
  #else
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(NAV, LEFTPINKIE, &bootloader)
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(NAV, LEFTINNERINDEX, U_NA)
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(NAV, RIGHTINNERINDEX, U_RDO)
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(NAV, RIGHTPINKIE, U_UND)

    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(MOUSE, LEFTPINKIE, &bootloader)
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(MOUSE, LEFTINNERINDEX, U_NA)
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(MOUSE, RIGHTINNERINDEX, U_RDO)
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(MOUSE, RIGHTPINKIE, U_UND)

    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(MEDIA, LEFTPINKIE, &bootloader)
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(MEDIA, LEFTINNERINDEX, U_NA)
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(MEDIA, RIGHTINNERINDEX, &rgb_ug RGB_TOG)
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(MEDIA, RIGHTPINKIE, &rgb_ug RGB_BRI)
  #endif
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(NUM, LEFTPINKIE, &kp LBKT)
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(NUM, LEFTINNERINDEX, &kp RBKT)
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(NUM, RIGHTINNERINDEX, U_NA)
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(NUM, RIGHTPINKIE, &bootloader)

    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(SYM, LEFTPINKIE, &kp LBRC)
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(SYM, LEFTINNERINDEX, &kp RBRC)
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(SYM, RIGHTINNERINDEX, U_NA)
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(SYM, RIGHTPINKIE, &bootloader)

    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(FUN, LEFTPINKIE, &kp F12)
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(FUN, LEFTINNERINDEX, &kp PSCRN)
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(FUN, RIGHTINNERINDEX, U_NA)
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(FUN, RIGHTPINKIE, &bootloader)
#endif
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(BUTTON, LEFTPINKIE, U_UND)
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(BUTTON, LEFTINNERINDEX, U_RDO)
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(BUTTON, RIGHTINNERINDEX, U_RDO)
    MIRYOKU_KLUDGE_TOPROWCOMBOS_MACRO(BUTTON, RIGHTPINKIE, U_UND)
  };
};
