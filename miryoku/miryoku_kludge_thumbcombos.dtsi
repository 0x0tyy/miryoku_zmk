// Copyright 2022 Manna Harbour
// https://github.com/manna-harbour/miryoku

#define MIRYOKU_KLUDGE_THUMBCOMBOS_TERM 200
#define MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(layer, position, binding) \
thumbcombos_ ## layer ## _ ## position { \
  layers = <layer>; \
  key-positions = <MIRYOKU_KLUDGE_THUMBCOMBOS_ ## position>; \
  bindings = <binding>; \
  timeout-ms = <MIRYOKU_KLUDGE_THUMBCOMBOS_TERM>; \
};

/ {
  combos {
    compatible = "zmk,combos";
#if defined (MIRYOKU_LAYERS_FLIP)
  #if defined (MIRYOKU_KLUDGE_THUMBCOMBOS_LEFT)
    MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(BASE, LEFT, &lt FUN DEL)
    MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(EXTRA, LEFT, &lt FUN DEL)
    MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(BUTTON, LEFT, U_BTN3)
    MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(NAV, LEFT, &kp DEL)
    MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(MOUSE, LEFT, U_BTN3)
    MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(MEDIA, LEFT, &kp C_MUTE)
  #endif
  #if defined (MIRYOKU_KLUDGE_THUMBCOMBOS_RIGHT)
    MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(BASE, RIGHT, &lt MEDIA ESC)
    MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(EXTRA, RIGHT, &lt MEDIA ESC)
    MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(BUTTON, RIGHT, U_BTN3)
    MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(NUM, RIGHT, &kp DOT)
    MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(SYM, RIGHT, &kp RPAR)
    MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(FUN, RIGHT, &kp K_APP)
  #endif
#else
  #if defined (MIRYOKU_KLUDGE_THUMBCOMBOS_LEFT)
    MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(BASE, LEFT, &lt MEDIA ESC)
    MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(EXTRA, LEFT, &lt MEDIA ESC)
    MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(BUTTON, LEFT, U_BTN3)
    MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(NUM, LEFT, &kp DOT)
    MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(SYM, LEFT, &kp LPAR)
    MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(FUN, LEFT, &kp K_APP)
  #endif
  #if defined (MIRYOKU_KLUDGE_THUMBCOMBOS_RIGHT)
    MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(BASE, RIGHT, &lt FUN DEL)
    MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(EXTRA, RIGHT, &lt FUN DEL)
    MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(BUTTON, RIGHT, U_BTN3)
    MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(NAV, RIGHT, &kp DEL)
    MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(MOUSE, RIGHT, U_BTN3)
    MIRYOKU_KLUDGE_THUMBCOMBOS_MACRO(MEDIA, RIGHT, &kp C_MUTE)
  #endif
#endif
  };
};
